<Window x:Class="DocCompareWPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:mah="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro"
        xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
        xmlns:local="clr-namespace:DocCompareWPF"
        mc:Ignorable="d"
        WindowStartupLocation="CenterScreen"
        Title="DocCompare" Height="600" Width="1024" MinWidth="1024" MinHeight="600" WindowStyle="None" AllowsTransparency="True" StateChanged="Window_StateChanged"
        FontSize="15" SizeChanged="Window_SizeChanged" LocationChanged="Window_LocationChanged">
    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="{Binding ActualHeight,ElementName=TitleBar}" />
    </WindowChrome.WindowChrome>
    <Border x:Name="outerBorder" BorderBrush="Black" UseLayoutRounding="True" SnapsToDevicePixels="True" BorderThickness="1">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="32" />
                <RowDefinition />
                <!--RowDefinition Height="32"/-->
            </Grid.RowDefinitions>
            <Popup x:Name="PopupBrowseFileBubble" PlacementTarget="{Binding ElementName=SidePanelOpenDocButton}" StaysOpen="True"
                   PopupAnimation="Fade" AllowsTransparency="True" VerticalOffset="-20" HorizontalOffset="10" Height="150" Placement="Bottom">
            <local:DialogBubble Message="Click on this tab to browse and inspect files before comparison"
                                StartPoint="5,40" TopPoint="5,10" EndPoint="35,40"
                                RectInnerMargin="20,60,20,20" RectPoint1="5,40" RectPoint2="295,40" RectPoint3="295,195" RectPoint4="5,195"
                                Height="130"></local:DialogBubble>
            </Popup>
            <Popup x:Name="PopupBrowseFileButtonBubble" PlacementTarget="{Binding ElementName=BrowseFileButton1}" StaysOpen="True"
                   PopupAnimation="Fade" AllowsTransparency="True" VerticalOffset="120" HorizontalOffset="0" Height="250" Placement="Center">
                <local:DialogBubble Message="Click on this button to browse files for inspection. Alternatively, you can drag and drop files into this zone to load them.            
                                          A total of 5 files can be loaded at once.            Try click on this button and select all 3 example files." 
                                StartPoint="120,40" TopPoint="150,10" EndPoint="180,40"
                                RectInnerMargin="20,60,20,20" RectPoint1="5,40" RectPoint2="295,40" RectPoint3="295,215" RectPoint4="5,215"
                                Height="230"></local:DialogBubble>
            </Popup>
            <Popup x:Name="PopupBrowseFileButton2Bubble" PlacementTarget="{Binding ElementName=BrowseFileButton2}" StaysOpen="True"
                   PopupAnimation="Fade" AllowsTransparency="True" VerticalOffset="70" HorizontalOffset="0" Height="150" Placement="Center">
                <local:DialogBubble Message="Please load all example files for comparison." 
                                StartPoint="120,40" TopPoint="150,10" EndPoint="180,40"
                                RectInnerMargin="20,60,20,20" RectPoint1="5,40" RectPoint2="295,40" RectPoint3="295,215" RectPoint4="5,215"
                                Height="130"></local:DialogBubble>
            </Popup>
            <Popup x:Name="PopupDocPreviewNameComboboxBubble" PlacementTarget="{Binding ElementName=Doc1NameLabelComboBox}" StaysOpen="True"
                   PopupAnimation="Fade" AllowsTransparency="True" VerticalOffset="60" HorizontalOffset="0" Height="150" Placement="Center">
                <local:DialogBubble Message="Use the dropdown menu to view other loaded documents" 
                                StartPoint="120,40" TopPoint="150,10" EndPoint="180,40"
                                RectInnerMargin="20,60,20,20" RectPoint1="5,40" RectPoint2="295,40" RectPoint3="295,215" RectPoint4="5,215"
                                Height="130"></local:DialogBubble>
            </Popup>
            <Popup x:Name="PopupDocPreviewInfoButtonBubble" PlacementTarget="{Binding ElementName=ShowDoc2FileInfoButton}" StaysOpen="True"
                   PopupAnimation="Fade" AllowsTransparency="True" VerticalOffset="0" HorizontalOffset="-290" Height="150" Placement="Top">
                <local:DialogBubble Message="Click on this button to view more document attributes" 
                                StartPoint="265,75" TopPoint="295,115" EndPoint="295,75"
                                RectInnerMargin="20,20,60,20" RectPoint1="5,5" RectPoint2="295,5" RectPoint3="295,75" RectPoint4="5,75"
                                Height="115"></local:DialogBubble>
            </Popup>
            <Popup x:Name="PopupDocPreviewInfoButton2Bubble" PlacementTarget="{Binding ElementName=ShowDoc2FileInfoButton}" StaysOpen="True"
                   PopupAnimation="Fade" AllowsTransparency="True" VerticalOffset="0" HorizontalOffset="-290" Height="150" Placement="Top">
                <local:DialogBubble Message="Click again on this button to hide document attributes" 
                                StartPoint="265,75" TopPoint="295,115" EndPoint="295,75"
                                RectInnerMargin="20,20,60,20" RectPoint1="5,5" RectPoint2="295,5" RectPoint3="295,75" RectPoint4="5,75"
                                Height="115"></local:DialogBubble>
            </Popup>
            <Popup x:Name="PopupCompareDocBubble" PlacementTarget="{Binding ElementName=SidePanelDocCompareButton}" StaysOpen="True"
                   PopupAnimation="Fade" AllowsTransparency="True" VerticalOffset="-20" HorizontalOffset="15" Height="150">
                <local:DialogBubble Message="Click on this tab to switch to compare mode after document selection."
                                StartPoint="5,40" TopPoint="5,10" EndPoint="35,40"
                                RectInnerMargin="20,60,20,20" RectPoint1="5,40" RectPoint2="295,40" RectPoint3="295,195" RectPoint4="5,195"
                                Height="130"></local:DialogBubble>
            </Popup>
            <Popup x:Name="PopupHighlightOffBubble" PlacementTarget="{Binding ElementName=HideMaskButton}" StaysOpen="True"
                   PopupAnimation="Fade" AllowsTransparency="True" VerticalOffset="-10" HorizontalOffset="-140" Height="160">
                <local:DialogBubble Message="Document differences are highlighted. Click on this button to toggle highlighting"
                                StartPoint="120,40" TopPoint="150,10" EndPoint="180,40"
                                RectInnerMargin="20,60,20,20" RectPoint1="5,40" RectPoint2="295,40" RectPoint3="295,195" RectPoint4="5,195"
                                Height="140"></local:DialogBubble>
            </Popup>
            <Popup x:Name="PopupOpenOriBubble" PlacementTarget="{Binding ElementName=OpenDoc2OriginalButton}" StaysOpen="True"
                   PopupAnimation="Fade" AllowsTransparency="True" VerticalOffset="-10" HorizontalOffset="-140" Height="160">
                <local:DialogBubble Message="Click this button to open the file in external editor."
                                StartPoint="120,40" TopPoint="150,10" EndPoint="180,40"
                                RectInnerMargin="20,60,20,20" RectPoint1="5,40" RectPoint2="295,40" RectPoint3="295,195" RectPoint4="5,195"
                                Height="140"></local:DialogBubble>
            </Popup>
            <Popup x:Name="PopupReloadBubble" PlacementTarget="{Binding ElementName=ReloadDocCompare2Button}" StaysOpen="True"
                   PopupAnimation="Fade" AllowsTransparency="True" VerticalOffset="-10" HorizontalOffset="-140" Height="160">
                <local:DialogBubble Message="Click this button to reload the file in after editing."
                                StartPoint="120,40" TopPoint="150,10" EndPoint="180,40"
                                RectInnerMargin="20,60,20,20" RectPoint1="5,40" RectPoint2="295,40" RectPoint3="295,195" RectPoint4="5,195"
                                Height="140"></local:DialogBubble>
            </Popup>
            <Popup x:Name="PopupLinkPageBubble" PlacementTarget="{Binding ElementName=DocCompareSideListViewLeft}" StaysOpen="True"
                   PopupAnimation="Fade" AllowsTransparency="True" VerticalOffset="260" HorizontalOffset="-65" Height="260" Placement="Top">
                <local:DialogBubble Message="Pages are aligned automatically. If you would like to change the alignment manually, mouse over and click the 'link' icon on a page in the miniature preview, then choose any page in the second document to align these two pages."
                                StartPoint="120,40" TopPoint="150,10" EndPoint="180,40"
                                RectInnerMargin="20,60,20,20" RectPoint1="5,40" RectPoint2="295,40" RectPoint3="295,255" RectPoint4="5,255"
                                Height="200"></local:DialogBubble>
            </Popup>
            <Popup x:Name="PopupUnlinkBubble" PlacementTarget="{Binding ElementName=RemoveAllForceAlignButton}" StaysOpen="True" Placement="Bottom"
                   PopupAnimation="Fade" AllowsTransparency="True" VerticalOffset="0" HorizontalOffset="-290" Height="170">
                <local:DialogBubble Message="Click here to remove all previously set link. Click on the icon between pages to remove individual links."
                                StartPoint="265,40" TopPoint="295,10" EndPoint="295,40"
                                RectInnerMargin="20,60,20,20" RectPoint1="5,40" RectPoint2="295,40" RectPoint3="295,195" RectPoint4="5,195"
                                Height="150"></local:DialogBubble>
            </Popup>
            <Popup x:Name="PopupAnimateBubble" StaysOpen="True"
                   PopupAnimation="Fade" AllowsTransparency="True" VerticalOffset="100" HorizontalOffset="30" Height="180" Placement="Center">
                <local:DialogBubble Message="When differences are difficult to spot, mouse over the page, press and hold down this icon – it will overlay the two slides for visual comparison."
                                StartPoint="120,40" TopPoint="150,10" EndPoint="180,40"
                                RectInnerMargin="20,60,20,20" RectPoint1="5,40" RectPoint2="295,40" RectPoint3="295,195" RectPoint4="5,195"
                                Height="160"></local:DialogBubble>
            </Popup>
            <Grid Grid.Row="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="30" />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <Grid x:Name="LogoZone" Grid.Column="0" Grid.Row="0" VerticalAlignment="Stretch" Background="{StaticResource PrimaryHueDarkBrush}">
                    <Image Source="/Resources/Icons/LogoSmallest.png" Margin="5,3,3,3"></Image>
                </Grid>
                <Grid x:Name="TitleBar" Grid.Column="1" Grid.Row="0" VerticalAlignment="Stretch" Background="{StaticResource PrimaryHueDarkBrush}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Label x:Name="WindowTitle" FontSize="15" VerticalAlignment="Center" Foreground="White">2|Compare</Label>
                        <Grid Grid.Column="1" MaxWidth="120"  MinWidth="120" HorizontalAlignment="Right">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition />
                                <ColumnDefinition />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Button x:Name="WindowUpdateButton" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="{StaticResource PrimaryHueDarkBrush}" Foreground="Yellow" Grid.Column="0" Padding="0" BorderThickness="0" Click="WindowUpdateButton_Click" WindowChrome.IsHitTestVisibleInChrome="True" Visibility="Hidden" ToolTip="A newer version of 2|compare is available. Click here to download the installer.">
                                <iconPacks:PackIconMaterialDesign Kind="NewReleases" Width="16" Height="16" VerticalAlignment="Center" HorizontalAlignment="Center" />
                            </Button>
                            <Button x:Name="WindowMinimizeButton" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="{StaticResource PrimaryHueDarkBrush}" Foreground="White" Grid.Column="1" Padding="0" BorderThickness="0" Click="WindowMinimizeButton_Click" WindowChrome.IsHitTestVisibleInChrome="True">
                                <iconPacks:PackIconMaterial Kind="WindowMinimize" Width="12" Height="12" VerticalAlignment="Center" HorizontalAlignment="Center" />
                            </Button>
                            <Button x:Name="WindowRestoreButton" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="{StaticResource PrimaryHueDarkBrush}" Foreground="White" Grid.Column="2" Padding="0" BorderThickness="0" Click="WindowRestoreButton_Click" Visibility="Hidden" WindowChrome.IsHitTestVisibleInChrome="True">
                                <iconPacks:PackIconMaterial Kind="WindowRestore" Width="12" Height="12" VerticalAlignment="Center" HorizontalAlignment="Center" />
                            </Button>
                            <Button x:Name="WindowMaximizeButton" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="{StaticResource PrimaryHueDarkBrush}" Foreground="White" Grid.Column="2" Padding="0" BorderThickness="0" Click="WindowMaximizeButton_Click" WindowChrome.IsHitTestVisibleInChrome="True">
                                <iconPacks:PackIconMaterial Kind="WindowMaximize" Width="12" Height="12" VerticalAlignment="Center" HorizontalAlignment="Center" />
                            </Button>
                            <Button x:Name="WindowCloseButton" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="{StaticResource PrimaryHueDarkBrush}" Foreground="White" Grid.Column="3" Padding="0" BorderThickness="0" Click="WindowCloseButton_Click" WindowChrome.IsHitTestVisibleInChrome="True" Cursor="Hand">
                                <iconPacks:PackIconMaterial Kind="WindowClose" Width="12" Height="12" VerticalAlignment="Center" HorizontalAlignment="Center" />
                            </Button>
                        </Grid>
                    </Grid>
                </Grid>
            </Grid>
            <Grid Grid.Row="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="40" />
                    <RowDefinition />
                </Grid.RowDefinitions>
                <Grid x:Name="SidePanel" Grid.Row="0" VerticalAlignment="Stretch" Background="{StaticResource PrimaryHueDarkBrush}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="40" />
                            <ColumnDefinition Width="40" />
                            <ColumnDefinition />
                            <ColumnDefinition Width="40" />
                        </Grid.ColumnDefinitions>
                        <Grid x:Name="SidePanelOpenDocBackground" Grid.Column="0" Margin="0,0,0,0" Height="50" Background="Transparent">
                            <Button x:Name="SidePanelOpenDocButton" Style="{StaticResource MahApps.Styles.Button.Flat}"  HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                    Padding="0" ToolTip="Browse documents" Background="Transparent" BorderBrush="Transparent" Click="SidePanelOpenDocButton_Click" Margin="0,-10,0,0">
                                <iconPacks:PackIconMaterial Kind="FileDocumentMultiple" Height="20" Width="20" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="White" />
                            </Button>
                        </Grid>
                        <Grid x:Name="SidePanelDocCompareBackground" Grid.Column="1" Margin="0,0,0,0" Height="50" Background="Transparent">
                            <Button x:Name="SidePanelDocCompareButton" Style="{StaticResource MahApps.Styles.Button.Flat}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                    Padding="0" ToolTip="Compare documents" Background="Transparent" BorderBrush="Transparent" Click="SidePanelDocCompareButton_Click" Margin="0,-10,0,0">
                                <iconPacks:PackIconMaterial Kind="Compare" Height="20" Width="20" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="White" />
                            </Button>
                        </Grid>
                        <Grid x:Name="SettingsButtonBackground" Grid.Column="3" Margin="0,0,0,0" Height="50" Background="Transparent">
                            <Button x:Name="SettingsButton" Style="{StaticResource MahApps.Styles.Button.Flat}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                    Padding="0" ToolTip="Settings" Background="Transparent" BorderBrush="Transparent" Click="SettingsButton_Click" Margin="0,-10,0,0">
                                <iconPacks:PackIconMaterial Kind="Cog" Height="20" Width="20" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="White" />
                            </Button>
                        </Grid>
                    </Grid>
                </Grid>
                <Grid x:Name="MainPanel" Grid.Row="1">
                    <Grid x:Name="DragDropPanel" Visibility="Visible" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="auto"/>
                        </Grid.RowDefinitions>
                        <Grid x:Name="DocCompareFirstDocZone" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="White" AllowDrop="True" DragOver="DocCompareDragDropZone1_DragOver" Drop="DocCompareDragDropZone1_Drop">
                            <Grid x:Name="DocCompareDragDropZone1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" AllowDrop="True">
                                <Border Margin="20" BorderBrush="Gray" BorderThickness="1" CornerRadius="10" AllowDrop="True">
                                    <Grid x:Name="DocCompareColorZone1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" AllowDrop="True">
                                        <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                                            <Grid.RowDefinitions>
                                                <RowDefinition />
                                                <RowDefinition />
                                                <RowDefinition />
                                            </Grid.RowDefinitions>
                                            <iconPacks:PackIconZondicons Kind="InboxDownload" HorizontalAlignment="Center" Width="50" Height="50" />
                                            <Label x:Name="DocCompareDropZone1Label" Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center">Drag and drop files here or</Label>
                                            <Button x:Name="BrowseFileButton1" Grid.Row="2" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" BorderThickness="0.5" BorderBrush="Gray" HorizontalAlignment="Center" Margin="0,10,0,0" Padding="10,0,10,0"
                                                Click="BrowseFileButton1_Click">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition />
                                                        <ColumnDefinition />
                                                    </Grid.ColumnDefinitions>
                                                    <iconPacks:PackIconUnicons Kind="FolderOpen" VerticalAlignment="Center" />
                                                    <Label  Margin="10,0,0,0" Grid.Column="1" VerticalAlignment="Center">Browse Files</Label>
                                                </Grid>
                                            </Button>
                                        </Grid>
                                    </Grid>
                                </Border>
                                <Grid x:Name="Doc1Grid" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Visibility="Hidden">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="{StaticResource TopBarHeight}" />
                                        <RowDefinition />
                                        <RowDefinition Height="auto" />
                                    </Grid.RowDefinitions>
                                    <Grid Grid.Row="0" Background="{DynamicResource SecondaryAccentBrush}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                        <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition />
                                                <ColumnDefinition Width="30" />
                                            </Grid.ColumnDefinitions>
                                            <Label Foreground="Black" Margin="85, 0,0,0" Background="{StaticResource RefDocumentBackGroundBrush}">Reference</Label>
                                            <ComboBox x:Name="Doc1NameLabelComboBox" Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Center" Foreground="White" Style="{StaticResource MahApps.Styles.ComboBox}" Background="Transparent" BorderThickness="0" Margin="10,0,30,0" SelectedIndex="0" SelectionChanged="Doc1NameLabelComboBox_SelectionChanged"
                                                      IsEditable="False" FontSize="14" DropDownOpened="Doc1NameLabelComboBox_DropDownOpened" DropDownClosed="Doc1NameLabelComboBox_DropDownClosed">
                                                <ComboBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding}" TextTrimming="CharacterEllipsis" />
                                                    </DataTemplate>
                                                </ComboBox.ItemTemplate>
                                            </ComboBox>
                                            <Button x:Name="BrowseFileTopButton1" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Padding="0" BorderThickness="0" VerticalAlignment="Center" Height="{StaticResource BarButtonHeight}"
                                            HorizontalAlignment="Left" Click="BrowseFileButton1_Click" Margin="10,0,0,0" ToolTip="Browse document">
                                                <iconPacks:PackIconFontAwesome Kind="FolderOpenSolid" Width="{StaticResource SmallIconSize}" Height="{StaticResource SmallIconSize}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White" />
                                            </Button>
                                            <Button x:Name="OpenDoc1OriginalButton1" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Padding="0" BorderThickness="0" VerticalAlignment="Center" Height="{StaticResource BarButtonHeight}"
                                            HorizontalAlignment="Left" Click="OpenDoc1OriginalButton_Click" Margin="35,0,0,0" ToolTip="Open original">
                                                <iconPacks:PackIconFontAwesome Kind="ExternalLinkAltSolid" Width="{StaticResource SmallIconSize}" Height="{StaticResource SmallIconSize}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White" />
                                            </Button>
                                            <Button x:Name="ReloadDoc1Button" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Padding="0" BorderThickness="0" VerticalAlignment="Center" Height="25"
                                            HorizontalAlignment="Left" Click="ReloadDoc1Button_Click" Margin="60,0,0,0" ToolTip="Reload document">
                                                <iconPacks:PackIconZondicons Kind="Reload" Width="{StaticResource SmallIconSize}" Height="{StaticResource SmallIconSize}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White" />
                                            </Button>
                                            <Button x:Name="CloseDoc1Button" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Grid.Column="2" Padding="0" BorderThickness="0" VerticalAlignment="Center" Height="25" Click="CloseDoc1Button_Click">
                                                <iconPacks:PackIconMaterial Kind="WindowClose" Width="{StaticResource SmallIconSize}" Height="{StaticResource SmallIconSize}" VerticalAlignment="Center" HorizontalAlignment="Center"  Foreground="White" />
                                            </Button>
                                        </Grid>
                                    </Grid>
                                    <ListView x:Name="DocCompareListView1" Grid.Row="1" HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch" VerticalAlignment="Stretch" ScrollViewer.ScrollChanged="DocCompareScrollViewer1_ScrollChanged" Background="{StaticResource RefDocumentBackGroundBrush}"
                                        VirtualizingPanel.IsVirtualizing="True" VirtualizingPanel.IsVirtualizingWhenGrouping="True" VirtualizingPanel.VirtualizationMode="Recycling"
                                        ScrollViewer.HorizontalScrollBarVisibility="Disabled" ScrollViewer.VerticalScrollBarVisibility="Visible">
                                        <ListView.ItemContainerStyle>
                                            <Style TargetType="ListViewItem">
                                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>                                          
                                                <Setter Property="Background" Value="Transparent"/>  
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="{x:Type ListViewItem}">   
                                                            <Grid HorizontalAlignment="Stretch" Background="Transparent">                                         
                                                                <Image Source="{Binding PathToFile, Converter={StaticResource uriToImageConv}}" Margin="{Binding Margin}" HorizontalAlignment="Stretch" Stretch="Uniform">
                                                                    <Image.Effect>
                                                                        <DropShadowEffect ShadowDepth="0" BlurRadius="10"></DropShadowEffect>
                                                                    </Image.Effect>
                                                                </Image>
                                                                <TextBlock HorizontalAlignment="Center" Visibility="{Binding EoDVisi}" Margin="5">End of Document</TextBlock>
                                                            </Grid>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter> 
                                            </Style>                                        
                                        </ListView.ItemContainerStyle>
                                    </ListView>
                                    
                                </Grid>
                                <mah:Tile x:Name="ProgressBarDoc1" Padding="4" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="Hidden" Height="40" Width="120" Background="White" BorderBrush="Black" BorderThickness="1">
                                    <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <mah:ProgressRing Foreground="Black" IsActive="True" Width="1" Height="1" />
                                        <Label Grid.Column="1" Margin="10,0,0,0">Loading</Label>
                                    </Grid>
                                </mah:Tile>
                            </Grid>
                        </Grid>
                        <Grid x:Name="DocCompareSecondDocZone" Visibility="Visible" Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="White" AllowDrop="True" DragOver="DocCompareDragDropZone2_DragOver" Drop="DocCompareDragDropZone2_Drop">
                            <Grid x:Name="DocCompareDragDropZone2" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" AllowDrop="True">
                                <Border Margin="20" BorderBrush="Gray" BorderThickness="1" CornerRadius="10">
                                    <Grid x:Name="DocCompareColorZone2" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                        <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                                            <Grid.RowDefinitions>
                                                <RowDefinition />
                                                <RowDefinition />
                                                <RowDefinition />
                                            </Grid.RowDefinitions>
                                            <iconPacks:PackIconZondicons Kind="InboxDownload" HorizontalAlignment="Center" Width="50" Height="50" />
                                            <Label x:Name="DocCompareDropZone2Label" Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center">Drag and drop files here</Label>
                                            <Button x:Name="BrowseFileButton2" Grid.Row="2" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" BorderThickness="0.5" BorderBrush="Gray" HorizontalAlignment="Center" Margin="0,10,0,0" Padding="10,0,10,0"
                                                Click="BrowseFileButton2_Click">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition />
                                                        <ColumnDefinition />
                                                    </Grid.ColumnDefinitions>
                                                    <iconPacks:PackIconUnicons Kind="FolderOpen" VerticalAlignment="Center" />
                                                    <Label  Margin="10,0,0,0" Grid.Column="1" VerticalAlignment="Center">Browse Files</Label>
                                                </Grid>
                                            </Button>
                                        </Grid>
                                    </Grid>
                                </Border>
                                <Grid x:Name="Doc2Grid" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"  Visibility="Hidden">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="{StaticResource TopBarHeight}" />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <Grid Grid.Row="0" Background="{DynamicResource SecondaryAccentBrush}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                        <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition />
                                                <ColumnDefinition Width="30" />
                                            </Grid.ColumnDefinitions>
                                            <Label Foreground="Black" Background="{StaticResource DocumentBackGroundBrush}" Margin="85, 0,0,0">Compared</Label>
                                            <ComboBox x:Name="Doc2NameLabelComboBox" Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Center" Foreground="White" Style="{StaticResource MahApps.Styles.ComboBox}" Background="Transparent" BorderThickness="0" Margin="10,0,30,0" SelectedIndex="0" SelectionChanged="Doc2NameLabelComboBox_SelectionChanged"
                                                      IsEditable="False" Padding="0,0,0,0" FontSize="14">
                                                <ComboBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding}" TextTrimming="CharacterEllipsis" />
                                                    </DataTemplate>
                                                </ComboBox.ItemTemplate>
                                            </ComboBox>
                                            <Button x:Name="BrowseFileTopButton2" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Padding="0" BorderThickness="0" VerticalAlignment="Center" Height="{StaticResource BarButtonHeight}"
                                            HorizontalAlignment="Left" Click="BrowseFileButton2_Click" Margin="10,0,0,0" ToolTip="Browse document">
                                                <iconPacks:PackIconFontAwesome Kind="FolderOpenSolid" Width="{StaticResource SmallIconSize}" Height="{StaticResource SmallIconSize}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White" />
                                            </Button>
                                            <Button x:Name="OpenDoc2OriginalButton2" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Padding="0" BorderThickness="0" VerticalAlignment="Center" Height="25"
                                            HorizontalAlignment="Left" Click="OpenDoc2OriginalButton_Click" Margin="35,0,0,0" ToolTip="Open original">
                                                <iconPacks:PackIconFontAwesome Kind="ExternalLinkAltSolid" Width="{StaticResource SmallIconSize}" Height="{StaticResource SmallIconSize}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White" />
                                            </Button>

                                            <Button x:Name="ReloadDoc2Button" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Padding="0" BorderThickness="0" VerticalAlignment="Center" Height="25"
                                            HorizontalAlignment="Left" Click="ReloadDoc2Button_Click" Margin="60,0,0,0" ToolTip="Reload document">
                                                <iconPacks:PackIconZondicons Kind="Reload" Width="{StaticResource SmallIconSize}" Height="{StaticResource SmallIconSize}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White" />
                                            </Button>
                                            <Button x:Name="CloseDoc2Button" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Grid.Column="2" Padding="0" BorderThickness="0" VerticalAlignment="Center" Height="25" Click="CloseDoc2Button_Click">
                                                <iconPacks:PackIconMaterial Kind="WindowClose" Width="{StaticResource SmallIconSize}" Height="{StaticResource SmallIconSize}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White" />
                                            </Button>
                                        </Grid>
                                    </Grid>
                                    <ListView x:Name="DocCompareListView2" Grid.Row="1" HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch" VerticalAlignment="Stretch" ScrollViewer.ScrollChanged="DocCompareScrollViewer2_ScrollChanged" Background="{StaticResource DocumentBackGroundBrush}"
                                        VirtualizingPanel.IsVirtualizing="True" VirtualizingPanel.IsVirtualizingWhenGrouping="True" VirtualizingPanel.VirtualizationMode="Recycling"
                                        ScrollViewer.HorizontalScrollBarVisibility="Disabled" ScrollViewer.VerticalScrollBarVisibility="Visible">
                                        <ListView.ItemContainerStyle>
                                            <Style TargetType="ListViewItem">
                                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>                                          
                                                <Setter Property="Background" Value="Transparent"/>  
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="{x:Type ListViewItem}">   
                                                            <Grid HorizontalAlignment="Stretch" Background="Transparent">                                         
                                                                <Image Source="{Binding PathToFile, Converter={StaticResource uriToImageConv}}" Margin="{Binding Margin}" HorizontalAlignment="Stretch" Stretch="Uniform">
                                                                    <Image.Effect>
                                                                        <DropShadowEffect ShadowDepth="0" BlurRadius="10"></DropShadowEffect>
                                                                    </Image.Effect>
                                                                </Image>
                                                                <TextBlock HorizontalAlignment="Center" Visibility="{Binding EoDVisi}" Margin="5">End of Document</TextBlock>
                                                            </Grid>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter> 
                                            </Style>                                        
                                        </ListView.ItemContainerStyle>
                                    </ListView>
                                    
                                </Grid>
                                <mah:Tile x:Name="ProgressBarDoc2" Padding="4" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="Hidden" Height="40" Width="120" Background="White" BorderBrush="Black" BorderThickness="1">
                                    <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <mah:ProgressRing Foreground="Black" IsActive="True" Width="1" Height="1" />
                                        <Label Grid.Column="1" Margin="10,0,0,0">Loading</Label>
                                    </Grid>
                                </mah:Tile>
                            </Grid>
                        </Grid>
                        <Grid x:Name="DocCompareThirdDocZone" Visibility="Visible" Grid.Column="2" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="White" AllowDrop="True" DragOver="DocCompareDragDropZone3_DragOver" Drop="DocCompareDragDropZone3_Drop">
                            <Grid x:Name="DocCompareDragDropZone3" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                <Border Margin="20" BorderBrush="Gray" BorderThickness="1" CornerRadius="10">
                                    <Grid x:Name="DocCompareColorZone3" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                        <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                                            <Grid.RowDefinitions>
                                                <RowDefinition />
                                                <RowDefinition />
                                                <RowDefinition />
                                            </Grid.RowDefinitions>
                                            <iconPacks:PackIconZondicons Kind="InboxDownload" HorizontalAlignment="Center" Width="50" Height="50" />
                                            <Label x:Name="DocCompareDropZone3Label" Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center">Drag and drop files here</Label>
                                            <Button x:Name="BrowseFileButton3" Grid.Row="2" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" BorderThickness="0.5" BorderBrush="Gray" HorizontalAlignment="Center" Margin="0,10,0,0" Padding="10,0,10,0"
                                                Click="BrowseFileButton3_Click">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition />
                                                        <ColumnDefinition />
                                                    </Grid.ColumnDefinitions>
                                                    <iconPacks:PackIconUnicons Kind="FolderOpen" VerticalAlignment="Center" />
                                                    <Label  Margin="10,0,0,0" Grid.Column="1" VerticalAlignment="Center">Browse Files</Label>
                                                </Grid>
                                            </Button>
                                        </Grid>
                                    </Grid>
                                </Border>
                                <Grid x:Name="Doc3Grid" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"  Visibility="Hidden">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="{StaticResource TopBarHeight}" />
                                        <RowDefinition />
                                        <RowDefinition Height="auto" />
                                    </Grid.RowDefinitions>
                                    <Grid Grid.Row="0" Background="{DynamicResource SecondaryAccentBrush}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                        <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition />
                                                <ColumnDefinition Width="30" />
                                            </Grid.ColumnDefinitions>
                                            <ComboBox x:Name="Doc3NameLabelComboBox" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="White" Style="{StaticResource MahApps.Styles.ComboBox}" Background="Transparent" BorderThickness="0" Margin="85,0,30,0" SelectedIndex="0" SelectionChanged="Doc3NameLabelComboBox_SelectionChanged"
                                                      IsEditable="False" Padding="30,0,30,0" FontSize="14">
                                                <ComboBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding}" TextTrimming="CharacterEllipsis" />
                                                    </DataTemplate>
                                                </ComboBox.ItemTemplate>
                                            </ComboBox>
                                            <Button x:Name="BrowseFileTopButton3" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Padding="0" BorderThickness="0" VerticalAlignment="Center" Height="{StaticResource BarButtonHeight}"
                                            HorizontalAlignment="Left" Click="BrowseFileButton3_Click" Margin="10,0,0,0" ToolTip="Browse document">
                                                <iconPacks:PackIconFontAwesome Kind="FolderOpenSolid" Width="{StaticResource SmallIconSize}" Height="{StaticResource SmallIconSize}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White" />
                                            </Button>
                                            <Button x:Name="OpenDoc3OriginalButton3" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Padding="0" BorderThickness="0" VerticalAlignment="Center" Height="25"
                                            HorizontalAlignment="Left" Click="OpenDoc3OriginalButton3_Click" Margin="35,0,0,0" ToolTip="Open original">
                                                <iconPacks:PackIconFontAwesome Kind="ExternalLinkAltSolid" Width="{StaticResource SmallIconSize}" Height="{StaticResource SmallIconSize}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White" />
                                            </Button>

                                            <Button x:Name="ReloadDoc3Button" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Padding="0" BorderThickness="0" VerticalAlignment="Center" Height="25"
                                            HorizontalAlignment="Left" Click="ReloadDoc3Button_Click" Margin="60,0,0,0" ToolTip="Reload document">
                                                <iconPacks:PackIconZondicons Kind="Reload" Width="{StaticResource SmallIconSize}" Height="{StaticResource SmallIconSize}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White" />
                                            </Button>
                                            <Button x:Name="CloseDoc3Button" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Grid.Column="1" Padding="0" BorderThickness="0" VerticalAlignment="Center" Height="25" Click="CloseDoc3Button_Click">
                                                <iconPacks:PackIconMaterial Kind="WindowClose" Width="{StaticResource SmallIconSize}" Height="{StaticResource SmallIconSize}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White" />
                                            </Button>
                                        </Grid>
                                    </Grid>
                                    <ListView x:Name="DocCompareListView3" Grid.Row="1" HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch" VerticalAlignment="Stretch" ScrollViewer.ScrollChanged="DocCompareScrollViewer3_ScrollChanged" Background="{StaticResource DocumentBackGroundBrush}"
                                        VirtualizingPanel.IsVirtualizing="True" VirtualizingPanel.IsVirtualizingWhenGrouping="True" VirtualizingPanel.VirtualizationMode="Recycling"
                                        ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                        <ListView.ItemContainerStyle>
                                            <Style TargetType="ListViewItem">
                                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>                                          
                                                <Setter Property="Background" Value="Transparent"/>  
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="{x:Type ListViewItem}">   
                                                            <Grid HorizontalAlignment="Stretch" Background="Transparent">                                         
                                                                <Image Source="{Binding PathToFile, Converter={StaticResource uriToImageConv}}" Margin="{Binding Margin}" HorizontalAlignment="Stretch" Stretch="Uniform">
                                                                    <Image.Effect>
                                                                        <DropShadowEffect ShadowDepth="0" BlurRadius="10"></DropShadowEffect>
                                                                    </Image.Effect>
                                                                </Image>
                                                            </Grid>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter> 
                                            </Style>                                        
                                        </ListView.ItemContainerStyle>
                                    </ListView>
                                    <Grid Grid.Row="2" Background="{DynamicResource SecondaryAccentBrush}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition Width="25"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="{StaticResource BottomBarHeight}"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <Label x:Name="Doc3PageNumberLabel" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="White"></Label>
                                        <Button x:Name="ShowDoc3FileInfoButton" Grid.Column="1" Padding="0" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Foreground="White" Click="ShowDoc3FileInfoButton_Click" IsEnabled="False">
                                            <iconPacks:PackIconFontAwesome Kind="InfoCircleSolid" />
                                        </Button>
                                        <Grid Grid.Row="1" x:Name="Doc3StatsGrid" Visibility="Visible" Background="{StaticResource PrimaryHueDarkBrush}">
                                            <Grid.RowDefinitions>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="2*"/>
                                                <ColumnDefinition Width="3*"/>
                                            </Grid.ColumnDefinitions>
                                            <Label x:Name="Doc3StatAuthorLabel0" Content="Original author" Foreground="White" Visibility="Collapsed"/>
                                            <Label Content="Last modified by" Foreground="White" Grid.Row="1"/>
                                            <Label x:Name="Doc3StatCreatedLabel0" Content="Created on" Foreground="White" Grid.Row="2" Visibility="Collapsed"/>
                                            <Label Content="Last modified on" Foreground="White" Grid.Row="3"/>
                                            <TextBlock TextWrapping="WrapWithOverflow" x:Name="Doc3StatAuthorLabel" Text="" Foreground="White" Grid.Row="0" Grid.Column="1" Visibility="Collapsed"/>
                                            <TextBlock TextWrapping="WrapWithOverflow" x:Name="Doc3StatLastEditorLabel" Text="" Foreground="White" Grid.Row="1" Grid.Column="1"/>
                                            <TextBlock TextWrapping="WrapWithOverflow" x:Name="Doc3StatCreatedLabel" Text="" Foreground="White" Grid.Row="2" Grid.Column="1" Visibility="Collapsed"/>
                                            <TextBlock TextWrapping="WrapWithOverflow" x:Name="Doc3StatModifiedLabel" Text="" Foreground="White" Grid.Row="3" Grid.Column="1"/>
                                        </Grid>
                                        <Grid Grid.Row="1" Grid.Column="1" Background="{StaticResource PrimaryHueDarkBrush}"></Grid>
                                    </Grid>
                                </Grid>
                                <mah:Tile x:Name="ProgressBarDoc3" Padding="4" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="Hidden" Height="40" Width="120" Background="White" BorderBrush="Black" BorderThickness="1">
                                    <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <mah:ProgressRing Foreground="Black" IsActive="True" Width="1" Height="1" />
                                        <Label Grid.Column="1" Margin="10,0,0,0">Loading</Label>
                                    </Grid>
                                </mah:Tile>
                            </Grid>
                        </Grid>
                        <Grid Grid.Row="1" x:Name="DocPreviewStatGrid" Visibility="Collapsed" Grid.ColumnSpan="3" Background="{DynamicResource SecondaryAccentBrush}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="{StaticResource BottomBarHeight}"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Label x:Name="Doc1PageNumberLabel" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="White"></Label>
                            <Button x:Name="ShowDoc1FileInfoButton" Grid.Column="0"  Visibility="Hidden" HorizontalAlignment="Right" Padding="0" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Foreground="White" Click="ShowDoc1FileInfoButton_Click" IsEnabled="False">
                                <iconPacks:PackIconFontAwesome Kind="InfoCircleSolid" />
                            </Button>
                            <Grid Grid.Row="1" x:Name="Doc1StatsGrid" Visibility="Visible" Background="{StaticResource PrimaryHueDarkBrush}">
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="2*"/>
                                    <ColumnDefinition Width="3*"/>
                                </Grid.ColumnDefinitions>
                                <Label VerticalAlignment="Center" x:Name="Doc1StatAuthorLabel0" Content="Original author" Foreground="White" Visibility="Collapsed"/>
                                <Label VerticalAlignment="Center" x:Name="Doc1StatLastEditorLabel0" Content="Last modified by" Foreground="White" Grid.Row="1" Visibility="Collapsed"/>
                                <Label VerticalAlignment="Center" x:Name="Doc1StatCreatedLabel0" Content="Created on" Foreground="White" Grid.Row="2" Visibility="Collapsed"/>
                                <Label VerticalAlignment="Center" Content="Last modified on" Foreground="White" Grid.Row="3"/>
                                <TextBlock VerticalAlignment="Center" TextWrapping="WrapWithOverflow" x:Name="Doc1StatAuthorLabel" Text="" Foreground="White" Grid.Row="0" Grid.Column="1" Visibility="Collapsed"/>
                                <TextBlock VerticalAlignment="Center" TextWrapping="WrapWithOverflow" x:Name="Doc1StatLastEditorLabel" Text="" Foreground="White" Grid.Row="1" Grid.Column="1" Visibility="Collapsed"/>
                                <TextBlock VerticalAlignment="Center" TextWrapping="WrapWithOverflow" x:Name="Doc1StatCreatedLabel" Text="" Foreground="White" Grid.Row="2" Grid.Column="1" Visibility="Collapsed"/>
                                <TextBlock VerticalAlignment="Center" TextWrapping="WrapWithOverflow" x:Name="Doc1StatModifiedLabel" Text="" Foreground="White" Grid.Row="3" Grid.Column="1"/>
                            </Grid>
                            <Label Grid.Column="1" x:Name="Doc2PageNumberLabel" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="White"></Label>
                            <Button Grid.Column="1" x:Name="ShowDoc2FileInfoButton" Margin="0,0,10,0" HorizontalAlignment="Right" Padding="0" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Foreground="White" Click="ShowDoc2FileInfoButton_Click" IsEnabled="True">
                                <iconPacks:PackIconFontAwesome Kind="InfoCircleSolid" />
                            </Button>
                            <Button Grid.Column="1" x:Name="LinkScrollButton" Visibility="Hidden" Margin="0,0,35,0" HorizontalAlignment="Right" Padding="0" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Foreground="White" Click="LinkScrollButton_Click" IsEnabled="True" ToolTip="Enable parallel scrolling">
                                <Rectangle Width="20" Height="20" Fill="{StaticResource linkscrollDrawingImage}"></Rectangle>
                            </Button>
                            <Button Grid.Column="1" x:Name="UnlinkScrollButton" Visibility="Visible" Margin="0,0,35,0" HorizontalAlignment="Right" Padding="0" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Foreground="White" Click="UnlinkScrollButton_Click" IsEnabled="True" ToolTip="Disable parallel scrolling">
                                <Rectangle Width="20" Height="20" Fill="{StaticResource unlinkscrollDrawingImage}"></Rectangle>
                            </Button>
                            <Grid Grid.Row="1" Grid.Column="1" x:Name="Doc2StatsGrid" Visibility="Collapsed" Background="{StaticResource PrimaryHueDarkBrush}">
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="2*"/>
                                    <ColumnDefinition Width="3*"/>
                                </Grid.ColumnDefinitions>
                                <Label VerticalAlignment="Center" x:Name="Doc2StatAuthorLabel0" Content="Original author" Foreground="White" Visibility="Collapsed"/>
                                <Label VerticalAlignment="Center" x:Name="Doc2StatLastEditorLabel0" Content="Last modified by" Foreground="White" Grid.Row="1" Visibility="Collapsed"/>
                                <Label VerticalAlignment="Center" x:Name="Doc2StatCreatedLabel0" Content="Created on" Foreground="White" Grid.Row="2" Visibility="Collapsed"/>
                                <Label VerticalAlignment="Center" Content="Last modified on" Foreground="White" Grid.Row="3"/>
                                <TextBlock VerticalAlignment="Center" TextWrapping="WrapWithOverflow" x:Name="Doc2StatAuthorLabel" Text="" Foreground="White" Grid.Row="0" Grid.Column="1" Visibility="Collapsed"/>
                                <TextBlock VerticalAlignment="Center" TextWrapping="WrapWithOverflow" x:Name="Doc2StatLastEditorLabel" Text="" Foreground="White" Grid.Row="1" Grid.Column="1" Visibility="Collapsed"/>
                                <TextBlock VerticalAlignment="Center" TextWrapping="WrapWithOverflow" x:Name="Doc2StatCreatedLabel" Text="" Foreground="White" Grid.Row="2" Grid.Column="1" Visibility="Collapsed"/>
                                <TextBlock VerticalAlignment="Center" TextWrapping="WrapWithOverflow" x:Name="Doc2StatModifiedLabel" Text="" Foreground="White" Grid.Row="3" Grid.Column="1"/>
                            </Grid>
                        </Grid>
                        
                    </Grid>
                    <Grid x:Name="DocComparePanel" Visibility="Hidden" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                        <mah:Tile x:Name="ProgressBarDocCompare" Padding="4" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="Hidden" Height="40" Width="220" Background="White" BorderBrush="Black" BorderThickness="1">
                            <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <mah:ProgressRing Foreground="Black" IsActive="True" Width="1" Height="1" />
                                <Label Grid.Column="1" Margin="10,0,0,0">Comparing documents</Label>
                            </Grid>
                        </mah:Tile>
                        <mah:Tile x:Name="ProgressBarLoadingResults" Padding="4" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="Hidden" Height="40" Width="220" Background="White" BorderBrush="Black" BorderThickness="1">
                            <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <mah:ProgressRing Foreground="Black" IsActive="True" Width="1" Height="1" />
                                <Label Grid.Column="1" Margin="10,0,0,0">Loading results</Label>
                            </Grid>
                        </mah:Tile>
                        <mah:Tile x:Name="ProgressBarDocCompareReload" Padding="4" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="Hidden" Height="40" Width="220" Background="White" BorderBrush="Black" BorderThickness="1">
                            <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <mah:ProgressRing Foreground="Black" IsActive="True" Width="1" Height="1" />
                                <Label Grid.Column="1" Margin="10,0,0,0">Reloading documents</Label>
                            </Grid>
                        </mah:Tile>
                        <mah:Tile x:Name="ProgressBarDocCompareAlign" Padding="4" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="Hidden" Height="40" Width="220" Background="White" BorderBrush="Black" BorderThickness="1">
                            <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <mah:ProgressRing Foreground="Black" IsActive="True" Width="1" Height="1" />
                                <Label Grid.Column="1" Margin="10,0,0,0">Aligning documents</Label>
                            </Grid>
                        </mah:Tile>
                        <Grid x:Name="docCompareGrid">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="{StaticResource TopBarHeight}" />
                                <RowDefinition />
                                <RowDefinition Height="auto" />
                            </Grid.RowDefinitions>
                            <Grid Grid.Row="0" Background="{DynamicResource SecondaryAccentBrush}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition MaxWidth="250" MinWidth="250" />
                                    </Grid.ColumnDefinitions>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <Button x:Name="OpenDoc1OriginalButton" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Grid.Column="0" Padding="0" BorderThickness="0" VerticalAlignment="Center" Height="25"
                                            HorizontalAlignment="Left" Click="OpenDoc1OriginalButton_Click_1" Margin="10,0,0,0" ToolTip="Open original" Cursor="Hand">
                                            <iconPacks:PackIconFontAwesome Kind="ExternalLinkAltSolid" Width="{StaticResource SmallIconSize}" Height="{StaticResource SmallIconSize}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White" />
                                        </Button>
                                        <Button x:Name="ReloadDocCompare1Button" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Padding="0" BorderThickness="0" VerticalAlignment="Center" Height="25"
                                            HorizontalAlignment="Left" Click="ReloadDocCompare1Button_Click" Margin="10,0,10,0" ToolTip="Reload document" Grid.Column="1">
                                            <iconPacks:PackIconZondicons Kind="Reload" Width="{StaticResource SmallIconSize}" Height="{StaticResource SmallIconSize}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White" />
                                        </Button>
                                        <Label Grid.Column="2" Background="{StaticResource RefDocumentBackGroundBrush}">Reference</Label>
                                        <TextBlock x:Name="DocCompareNameLabel1" Grid.Column="3" FontSize="14" HorizontalAlignment="Stretch" VerticalAlignment="Center" Foreground="White" Margin="10,0,10,0" Padding="0,0,0,0" TextTrimming="CharacterEllipsis"></TextBlock>
                                    </Grid>
                                    <Grid Grid.Column="1">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <Button x:Name="OpenDoc2OriginalButton" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Grid.Column="0" Padding="0" BorderThickness="0" VerticalAlignment="Center" Height="25"
                                            HorizontalAlignment="Left" Click="OpenDoc2OriginalButton_Click_1" Margin="10,0,0,0" ToolTip="Open original">
                                            <iconPacks:PackIconFontAwesome Kind="ExternalLinkAltSolid" Width="{StaticResource SmallIconSize}" Height="{StaticResource SmallIconSize}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White" />
                                        </Button>
                                        <Button x:Name="ReloadDocCompare2Button" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Grid.Column="1" Padding="0" BorderThickness="0" VerticalAlignment="Center" Height="25"
                                            HorizontalAlignment="Left" Click="ReloadDocCompare2Button_Click" Margin="10,0,10,0" ToolTip="Reload document">
                                            <iconPacks:PackIconZondicons Kind="Reload" Width="{StaticResource SmallIconSize}" Height="{StaticResource SmallIconSize}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White" />
                                        </Button>
                                        <Label Grid.Column="2" Background="{StaticResource DocumentBackGroundBrush}">Compared</Label>
                                        <ComboBox x:Name="DocCompareNameLabel2ComboBox" Grid.Column="3" HorizontalAlignment="Stretch" VerticalAlignment="Center" Foreground="White" Style="{StaticResource MahApps.Styles.ComboBox}" Background="Transparent" BorderThickness="0" Margin="10,0,10,0" SelectedIndex="0" SelectionChanged="DocCompareNameLabel2ComboBox_SelectionChanged"
                                                      IsEditable="False" Padding="0,0,0,0" FontSize="14">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding}" TextTrimming="CharacterEllipsis" />
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>
                                    </Grid>
                                    
                                    <Button x:Name="ShowMaskButton" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Grid.Column="2" Padding="0" BorderThickness="0" VerticalAlignment="Center" Height="25"
                                            HorizontalAlignment="Left" Click="ShowMaskButton_Click" Margin="0,0,10,0" Visibility="Hidden" ToolTip="Show difference mask">
                                        <iconPacks:PackIconMicrons Kind="Show" Width="{StaticResource SmallIconSize}" Height="{StaticResource SmallIconSize}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White" />
                                    </Button>
                                    <Button x:Name="HideMaskButton" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Grid.Column="2" Padding="0" BorderThickness="0" VerticalAlignment="Center" Height="25"
                                            HorizontalAlignment="Left" Click="HideMaskButton_Click" Margin="0,0,10,0" ToolTip="Hide difference mask">
                                        <iconPacks:PackIconMicrons Kind="Hide" Width="{StaticResource SmallIconSize}" Height="{StaticResource SmallIconSize}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White" />
                                    </Button>
                                    
                                    <!--Button x:Name="CloseDocCompareButton" Style="{StaticResource MaterialDesignFlatButton}" Grid.Column="2" Padding="0" BorderThickness="0" VerticalAlignment="Center" Height="25"
                                            HorizontalAlignment="Right" Click="CloseDocCompareButton_Click" Margin="0,0,10,0" ToolTip="Close comparison">
                                        <iconPacks:PackIconMaterial Kind="WindowClose" Width="{StaticResource SmallIconSize}" Height="{StaticResource SmallIconSize}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White" />
                                    </-->
                                    <Button x:Name="RemoveAllForceAlignButton" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Grid.Column="2" Padding="0" BorderThickness="0" VerticalAlignment="Center" Height="25"
                                            HorizontalAlignment="Center" Click="RemoveAllForceAlignButton_Click" Margin="0,0,00,0" ToolTip="Remove all links">
                                        <iconPacks:PackIconFontAwesome Kind="UnlinkSolid" Width="{StaticResource SmallIconSize}" Height="{StaticResource SmallIconSize}" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White" />
                                    </Button>
                                </Grid>
                            </Grid>
                            <Grid x:Name="DocCompareScrollViewerGrid" Grid.Row="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition MaxWidth="100" MinWidth="100"/>
                                    <ColumnDefinition MaxWidth="150" MinWidth="150"/>
                                </Grid.ColumnDefinitions>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>
                                    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="{StaticResource RefDocumentBackGroundBrush}"/>
                                    <Grid Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="{StaticResource DocumentBackGroundBrush}"/>
                                </Grid>
                                <Grid Grid.Column="1" Grid.ColumnSpan="2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>
                                    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="{StaticResource DocumentBackGroundBrush}"/>
                                    <Grid Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="{StaticResource DocumentBackGroundBrush}"/>
                                </Grid>
                                <ListView x:Name="DocCompareMainListView" Grid.Column="0" HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch" VerticalAlignment="Stretch" ScrollViewer.ScrollChanged="DocCompareMainScrollViewer_ScrollChanged" Background="Transparent"
                                    VirtualizingPanel.IsVirtualizing="True" VirtualizingPanel.IsVirtualizingWhenGrouping="True" VirtualizingPanel.VirtualizationMode="Recycling"
                                    ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                    <ListView.ItemContainerStyle>
                                        <Style TargetType="ListViewItem">
                                            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>                                          
                                            <Setter Property="Background" Value="Transparent"/>  
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="{x:Type ListViewItem}">   
                                                        <Grid Tag="{Binding ImgGridName}" IsHitTestVisible="true" HorizontalAlignment="Stretch" Background="Transparent">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition/>
                                                                <ColumnDefinition/>
                                                            </Grid.ColumnDefinitions>
                                                            <Grid Tag="{Binding ImgGridLeftName}" MouseEnter="HandleMainDocCompareGridMouseEnter" MouseLeave="HandleMainDocCompareGridMouseLeave" Background="Transparent">
                                                                <Image Tag="{Binding ImgLeftName}" Source="{Binding PathToImgLeft, Converter={StaticResource uriToImageConv}}" Margin="{Binding Margin}" HorizontalAlignment="Stretch" 
                                                                    VerticalAlignment="Center" Stretch="Uniform">
                                                                    <Image.Effect>
                                                                        <DropShadowEffect ShadowDepth="0" BlurRadius="10"></DropShadowEffect>
                                                                    </Image.Effect>
                                                                </Image>
                                                                <Image Tag="{Binding ImgAniLeftName}" Source="{Binding PathToAniImgLeft, Converter={StaticResource uriToImageConv}}" Margin="{Binding Margin}" HorizontalAlignment="Stretch" 
                                                                    VerticalAlignment="Center" Visibility="Hidden" Stretch="Uniform">
                                                                    <Image.Effect>
                                                                        <DropShadowEffect ShadowDepth="0" BlurRadius="10"></DropShadowEffect>
                                                                    </Image.Effect>
                                                                </Image>
                                                            </Grid>
                                                            <Grid Grid.Column="1" Tag="{Binding ImgGridRightName}" MouseEnter="HandleMainDocCompareGridMouseEnter" MouseLeave="HandleMainDocCompareGridMouseLeave">
                                                                <Image Tag="{Binding ImgRightName}" Source="{Binding PathToImgRight, Converter={StaticResource uriToImageConv}}" Margin="{Binding Margin}" HorizontalAlignment="Stretch" 
                                                                    VerticalAlignment="Center" Stretch="Uniform">
                                                                    <Image.Effect>
                                                                        <DropShadowEffect ShadowDepth="0" BlurRadius="10"></DropShadowEffect>
                                                                    </Image.Effect>
                                                                </Image>
                                                                <Image Tag="{Binding ImgAniRightName}" Source="{Binding PathToAniImgRight, Converter={StaticResource uriToImageConv}}" Margin="{Binding Margin}" HorizontalAlignment="Stretch" 
                                                                    VerticalAlignment="Center" Visibility="Hidden" Stretch="Uniform">
                                                                    <Image.Effect>
                                                                        <DropShadowEffect ShadowDepth="0" BlurRadius="10"></DropShadowEffect>
                                                                    </Image.Effect>
                                                                </Image>
                                                                <Image Tag="{Binding ImgMaskRightName}" Source="{Binding PathToMaskImgRight, Converter={StaticResource uriToImageConv}}" Margin="{Binding Margin}" HorizontalAlignment="Stretch" 
                                                                    VerticalAlignment="Center" Visibility="{Binding ShowMask}" Stretch="Uniform">                                                                        
                                                                </Image>
                                                                <Button Tag="{Binding AnimateDiffRightButtonName}" Height="25" Width="25" Padding="0" Margin="15,15,0,0" Foreground="Black" Background="White" HorizontalAlignment="Left" VerticalAlignment="Center" ToolTip="Click and hold to animate the difference" Visibility="Hidden"
                                                                    PreviewMouseDown="HandleMainDocCompareAnimateMouseDown" PreviewMouseUp="HandleMainDocCompareAnimateMouseRelease" IsEnabled="{Binding AniDiffButtonEnable}">
                                                                    <iconPacks:PackIconMaterial Kind="VectorDifference" Width="15" Height="15" />
                                                                </Button>
                                                            </Grid>
                                                        </Grid>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter> 
                                        </Style>                                        
                                    </ListView.ItemContainerStyle>
                                </ListView>
                                <ListView x:Name="DocCompareSideListViewLeft" Grid.Column="1" HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch" VerticalAlignment="Stretch" ScrollViewer.ScrollChanged="DocCompareSideScrollViewerLeft_ScrollChanged" Background="Transparent"
                                    VirtualizingPanel.IsVirtualizing="True" VirtualizingPanel.IsVirtualizingWhenGrouping="True" VirtualizingPanel.VirtualizationMode="Recycling"
                                    ScrollViewer.HorizontalScrollBarVisibility="Disabled" ScrollViewer.VerticalScrollBarVisibility="Hidden">
                                    <ListView.ItemContainerStyle>
                                        <Style TargetType="ListViewItem">
                                            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>                                          
                                            <Setter Property="Background" Value="Transparent"/>  
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="{x:Type ListViewItem}">   
                                                        <Grid Tag="{Binding GridName}" IsHitTestVisible="true" HorizontalAlignment="Stretch" MouseLeftButtonDown="HandleMouseClickOnSideScrollView"
                                                            Effect="{Binding GridEffect}">
                                                            <Grid.Background>
                                                                <SolidColorBrush Color="{Binding BackgroundBrush}"/>
                                                            </Grid.Background>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="0"/>
                                                                <ColumnDefinition Width="100"/>
                                                            </Grid.ColumnDefinitions>
                                                            <Label Content="{Binding PageNumberLabel}" HorizontalAlignment="Center" VerticalAlignment="Center" MinWidth="25" FontSize="12"></Label>
                                                            <Grid Tag="{Binding ImgGridName}" Grid.Column="1" MouseEnter="SideGridMouseEnter" MouseLeave="SideGridMouseLeave">
                                                                <Image Tag="{Binding ImgName}" Source="{Binding PathToImg, Converter={StaticResource uriToImageConv}}" Margin="{Binding Margin}" HorizontalAlignment="Stretch" 
                                                                    VerticalAlignment="Center" Stretch="Uniform">
                                                                    <Image.Effect>
                                                                        <DropShadowEffect ShadowDepth="0" BlurRadius="5"></DropShadowEffect>
                                                                    </Image.Effect>
                                                                </Image>
                                                                <Image Tag="{Binding ImgDummyName}" Source="{Binding PathToImgDummy, Converter={StaticResource uriToImageConv}}" Margin="{Binding Margin}" HorizontalAlignment="Stretch" 
                                                                    VerticalAlignment="Center" Stretch="Uniform" Visibility="Hidden">
                                                                </Image>
                                                                <Image Tag="{Binding ImgMaskName}" Source="{Binding PathToImgMask, Converter={StaticResource uriToImageConv}}" Margin="{Binding Margin}" HorizontalAlignment="Stretch" 
                                                                    VerticalAlignment="Center" Stretch="Uniform">
                                                                    <Image.Effect>
                                                                        <DropShadowEffect ShadowDepth="0" BlurRadius="5"></DropShadowEffect>
                                                                    </Image.Effect>
                                                                </Image>
                                                                <Button Tag="{Binding ForceAlignButtonName}" Height="25" Width="25" Padding="0" Foreground="Black" Background="White" HorizontalAlignment="Right" VerticalAlignment="Center" ToolTip="Link Pages" Visibility="Hidden"
                                                                    Click="SideGridButtonMouseClick" IsHitTestVisible="true">
                                                                    <iconPacks:PackIconFontAwesome Kind="LinkSolid" Width="15" Height="15" />
                                                                </Button>
                                                                <Button Tag="{Binding ForceAlignInvalidButtonName}" Height="25" Width="25" Padding="0" Foreground="Black" Background="White" HorizontalAlignment="Right" VerticalAlignment="Center" ToolTip="This link would cross a previously set link. Please remove that link before aligning these pages." Visibility="Hidden" IsHitTestVisible="true">
                                                                    <iconPacks:PackIconFontAwesome Kind="BanSolid" Width="15" Height="15" />
                                                                </Button>
                                                            </Grid>
                                                        </Grid>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter> 
                                        </Style>                                        
                                    </ListView.ItemContainerStyle>
                                </ListView>
                                <ListView x:Name="DocCompareSideListViewRight" Grid.Column="2" HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch" VerticalAlignment="Stretch" ScrollViewer.ScrollChanged="DocCompareSideScrollViewerRight_ScrollChanged" Background="Transparent"
                                    VirtualizingPanel.IsVirtualizing="True" VirtualizingPanel.IsVirtualizingWhenGrouping="True" VirtualizingPanel.VirtualizationMode="Recycling"
                                    ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                    <ListView.ItemContainerStyle>
                                        <Style TargetType="ListViewItem">
                                            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>                                          
                                            <Setter Property="Background" Value="Transparent"/>  
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="{x:Type ListViewItem}">   
                                                        <Grid Tag="{Binding GridName}" IsHitTestVisible="true" HorizontalAlignment="Stretch" MouseLeftButtonDown="HandleMouseClickOnSideScrollView"
                                                            Effect="{Binding GridEffect}">
                                                            <Grid.Background>
                                                                <SolidColorBrush Color="{Binding BackgroundBrush}"/>
                                                            </Grid.Background>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="30"/>
                                                                <ColumnDefinition Width="100"/>
                                                            </Grid.ColumnDefinitions>
                                                            <Button Tag="{Binding RemoveForceAlignButtonName}" Height="20" Width="20" Padding="0" Margin="0" Foreground="Black" Background="White" IsHitTestVisible="true" HorizontalAlignment="Center" VerticalAlignment="Center" ToolTip="Unlink pages"
                                                                Click="RemoveForceAlignClicked" Visibility="{Binding RemoveForceAlignButtonVisibility}" IsEnabled="{Binding RemoveForceAlignButtonEnable}">
                                                                <iconPacks:PackIconFontAwesome Kind="LinkSolid" Width="15" Height="15" />
                                                            </Button>
                                                            <Grid Tag="{Binding ImgGridName}" Grid.Column="1" MouseEnter="SideGridMouseEnter" MouseLeave="SideGridMouseLeave">
                                                                <Image Tag="{Binding ImgName}" Source="{Binding PathToImg, Converter={StaticResource uriToImageConv}}" Margin="{Binding Margin}" HorizontalAlignment="Stretch" 
                                                                    VerticalAlignment="Center" Stretch="Uniform">
                                                                    <Image.Effect>
                                                                        <DropShadowEffect ShadowDepth="0" BlurRadius="5"></DropShadowEffect>
                                                                    </Image.Effect>
                                                                </Image>
                                                                <Image Tag="{Binding ImgDummyName}" Source="{Binding PathToImgDummy, Converter={StaticResource uriToImageConv}}" Margin="{Binding Margin}" HorizontalAlignment="Stretch" 
                                                                    VerticalAlignment="Center" Stretch="Uniform" Visibility="Hidden">
                                                                    <Image.Effect>
                                                                        <DropShadowEffect ShadowDepth="0" BlurRadius="5"></DropShadowEffect>
                                                                    </Image.Effect>
                                                                </Image>
                                                                <Image Tag="{Binding ImgMaskName}" Source="{Binding PathToMask, Converter={StaticResource uriToImageConv}}" Margin="{Binding Margin}" HorizontalAlignment="Stretch" 
                                                                    VerticalAlignment="Center" Stretch="Uniform" Visibility="{Binding ShowMask}">
                                                                </Image>
                                                                <Button Tag="{Binding ForceAlignButtonName}" Height="25" Width="25" Padding="0" Foreground="Black" Background="White" HorizontalAlignment="Left" VerticalAlignment="Center" ToolTip="Link Pages" Visibility="Hidden"
                                                                    Click="SideGridButtonMouseClick" IsHitTestVisible="true">
                                                                    <iconPacks:PackIconFontAwesome Kind="LinkSolid" Width="15" Height="15" />
                                                                </Button>
                                                                <Button Tag="{Binding ForceAlignInvalidButtonName}" Height="25" Width="25" Padding="0" Foreground="Black" Background="White" HorizontalAlignment="Left" VerticalAlignment="Center" ToolTip="This link would cross a previously set link. Please remove that link before aligning these pages." Visibility="Hidden" IsHitTestVisible="true">
                                                                    <iconPacks:PackIconFontAwesome Kind="BanSolid" Width="15" Height="15" />
                                                                </Button>
                                                            </Grid>
                                                        </Grid>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter> 
                                        </Style>                                        
                                    </ListView.ItemContainerStyle>
                                </ListView>
                                <Grid x:Name="HighlightingDisableTip" HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="0,0,30,10" Opacity="0.7" Background="{StaticResource WarningBackgroundBrush}" Visibility="Hidden" Grid.Column="0">
                                    <Label>Highlighting disabled</Label>
                                </Grid>
                            </Grid>
                            <Grid Grid.Row="2" Background="{DynamicResource SecondaryAccentBrush}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition MinWidth="250" MaxWidth="250" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="{StaticResource BottomBarHeight}"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Label x:Name="DocComparePageNumberLabel1" HorizontalAlignment="Center" Grid.Column="0" VerticalAlignment="Center" Foreground="White"></Label>
                                    <Label x:Name="DocComparePageNumberLabel2" HorizontalAlignment="Center" Grid.Column="1" VerticalAlignment="Center" Foreground="White"></Label>
                                    <Button x:Name="ShowDocCompareFileInfoButton" Grid.Column="2" Padding="0" HorizontalAlignment="Right" Margin="0,0,10,0" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" Foreground="White" Click="ShowDocCompareFileInfoButton_Click" IsEnabled="False">
                                        <iconPacks:PackIconFontAwesome Kind="InfoCircleSolid" />
                                    </Button>
                                    <Grid Grid.Row="1" Grid.ColumnSpan="2" x:Name="DocCompareLeftStatsGrid" Visibility="Visible" Background="{StaticResource PrimaryHueDarkBrush}">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="1*"/>
                                            <RowDefinition Height="1*"/>
                                            <RowDefinition Height="1*"/>
                                            <RowDefinition Height="1*"/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="2*"/>
                                            <ColumnDefinition Width="3*"/>
                                            <ColumnDefinition Width="2*"/>
                                            <ColumnDefinition Width="3*"/>
                                        </Grid.ColumnDefinitions>
                                        <Label VerticalAlignment="Center" x:Name="DocCompareLeftStatAuthorLabel0" Content="Original author" Foreground="White" Visibility="Collapsed"/>
                                        <Label VerticalAlignment="Center" x:Name="DocCompareLeftStatLastEditorLabel0" Content="Last modified by" Foreground="White" Grid.Row="1" Visibility="Collapsed"/>
                                        <Label VerticalAlignment="Center" x:Name="DocCompareLeftStatCreatedLabel0" Content="Created on" Foreground="White" Grid.Row="2" Visibility="Collapsed"/>
                                        <Label VerticalAlignment="Center" Content="Last modified on" Foreground="White" Grid.Row="3"/>
                                        <TextBlock VerticalAlignment="Center" TextWrapping="WrapWithOverflow" x:Name="DocCompareLeftStatAuthorLabel" Text="" Foreground="White" Grid.Row="0" Grid.Column="1" Visibility="Collapsed"/>
                                        <TextBlock VerticalAlignment="Center" TextWrapping="WrapWithOverflow" x:Name="DocCompareLeftStatLastEditorLabel" Text="" Foreground="White" Grid.Row="1" Grid.Column="1" Visibility="Collapsed"/>
                                        <TextBlock VerticalAlignment="Center" TextWrapping="WrapWithOverflow" x:Name="DocCompareLeftStatCreatedLabel" Text="" Foreground="White" Grid.Row="2" Grid.Column="1" Visibility="Collapsed"/>
                                        <TextBlock VerticalAlignment="Center" TextWrapping="WrapWithOverflow" x:Name="DocCompareLeftStatModifiedLabel" Text="" Foreground="White" Grid.Row="3" Grid.Column="1"/>
                                        <Label VerticalAlignment="Center" x:Name="DocCompareRightStatAuthorLabel0" Content="Original author" Foreground="White" Visibility="Collapsed" Grid.Column="2"/>
                                        <Label VerticalAlignment="Center" x:Name="DocCompareRightStatLastEditorLabel0" Content="Last modified by" Foreground="White" Grid.Row="1" Grid.Column="2" Visibility="Collapsed"/>
                                        <Label VerticalAlignment="Center" x:Name="DocCompareRightStatCreatedLabel0" Content="Created on" Foreground="White" Grid.Row="2" Visibility="Collapsed" Grid.Column="2"/>
                                        <Label VerticalAlignment="Center" Content="Last modified on" Foreground="White" Grid.Row="3"  Grid.Column="2"/>
                                        <TextBlock VerticalAlignment="Center" TextWrapping="WrapWithOverflow" x:Name="DocCompareRightStatAuthorLabel" Text="" Foreground="White" Grid.Row="0" Grid.Column="3" Visibility="Collapsed"/>
                                        <TextBlock VerticalAlignment="Center" TextWrapping="WrapWithOverflow" x:Name="DocCompareRightStatLastEditorLabel" Text="" Foreground="White" Grid.Row="1" Grid.Column="3" Visibility="Collapsed"/>
                                        <TextBlock VerticalAlignment="Center" TextWrapping="WrapWithOverflow" x:Name="DocCompareRightStatCreatedLabel" Text="" Foreground="White" Grid.Row="2" Grid.Column="3" Visibility="Collapsed"/>
                                        <TextBlock VerticalAlignment="Center" TextWrapping="WrapWithOverflow" x:Name="DocCompareRightStatModifiedLabel" Text="" Foreground="White" Grid.Row="3" Grid.Column="3"/>
                                    </Grid>                                    
                                    <Grid Grid.Row="1" Grid.Column="2" Background="{StaticResource PrimaryHueDarkBrush}"></Grid>
                                    <Grid Grid.Row="1" Grid.Column="3" Background="{StaticResource PrimaryHueDarkBrush}"></Grid>
                                </Grid>
                            </Grid>
                        </Grid>
                    </Grid>
                    <Grid x:Name="SettingsPanel" Visibility="Hidden" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="220" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid Background="{StaticResource PrimaryPanelBrush}" VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="auto" />
                                    <RowDefinition Height="auto" />
                                    <RowDefinition Height="auto" />
                                    <RowDefinition Height="auto" />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <Button x:Name="SettingsSubscriptionButton" Grid.Row="0" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" BorderBrush="Transparent" Height="50" HorizontalAlignment="Stretch" Margin="0" Padding="0" Click="SettingsSubscriptionButton_Click">
                                    <Grid VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Width="200">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="40" />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <iconPacks:PackIconFontAwesome Kind="ShoppingBagSolid" Grid.Column="0" Height="20" Width="20" Foreground="Black" VerticalAlignment="Stretch" Margin="10,0,0,0" />
                                        <Label Grid.Column="1">Subscription</Label>
                                    </Grid>
                                </Button>
                                <!--Button x:Name="SettingsBrowseDocButton" Grid.Row="0" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="{StaticResource SidePanelActiveButton}"  BorderBrush="Transparent" Height="50"  HorizontalAlignment="Stretch" Margin="0" Padding="0"
                                        Click="SettingsBrowseDocButton_Click" Visibility="Collapsed">
                                    <Grid VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Width="200">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="40" />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <iconPacks:PackIconMaterial Kind="FileDocumentMultiple" Grid.Column="0" Height="20" Width="20" Foreground="Black" VerticalAlignment="Stretch" Margin="10,0,0,0" />
                                        <Label Grid.Column="1">Document browsing</Label>
                                    </Grid>
                                </Button-->
                                <Button x:Name="SettingsAboutButton" Grid.Row="1" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" BorderBrush="Transparent" Height="50"  HorizontalAlignment="Stretch" Margin="0" Padding="0"
                                        Click="SettingsAboutButton_Click">
                                    <Grid VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Width="200">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="40" />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <iconPacks:PackIconMaterial Kind="Information" Grid.Column="0" Height="20" Width="20" Foreground="Black" VerticalAlignment="Stretch" Margin="10,0,0,0" />
                                        <Label Grid.Column="1">About</Label>
                                    </Grid>
                                </Button>
                                <!--Button x:Name="SettingsDocCompareButton" Grid.Row="1" Style="{StaticResource MahApps.Styles.Button.Flat}" Background="Transparent" BorderBrush="Transparent" Height="50"  HorizontalAlignment="Stretch" Margin="0" Padding="0">
                                    <Grid VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Width="200" Visibility="Collapsed">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="40" />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <iconPacks:PackIconMaterial Kind="Compare" Grid.Column="0" Height="20" Width="20" Foreground="Black" VerticalAlignment="Stretch" Margin="10,0,0,0" />
                                        <Label Grid.Column="1">Document comparison</Label>
                                    </Grid>
                                </Button-->
                            </Grid>
                        </Grid>
                        <Grid x:Name="SettingsDocBrowsingPanel" Grid.Column="1" Margin="25">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="35" />
                                <RowDefinition Height="35" />
                                <RowDefinition Height="35" />
                                <RowDefinition Height="35" />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <!--Label FontWeight="Bold" FontSize="18">Default folder< />
                            <Grid Grid.Row="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition Width="150" />
                                </Grid.ColumnDefinitions>
                                <Label x:Name="SettingsDefaultFolderTextBox" Margin="20,0,0,0"></Label>
                                <Button x:Name="SettingsBrowDefaultFolderButton" Grid.Column="1" Style="{StaticResource MaterialDesignOutlinedButton}" HorizontalAlignment="Center" Margin="5,0,0,0"
                                                Click="SettingsBrowDefaultFolderButton_Click" Height="35" Width="140" HorizontalContentAlignment="Stretch">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="20" />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <iconPacks:PackIconUnicons Kind="FolderOpen" VerticalAlignment="Center" />
                                        <Label  Margin="10,0,0,0" Grid.Column="1" VerticalAlignment="Center">Browse</Label>
                                    </Grid>
                                </Button>
                            </Grid>
                            <Label FontWeight="Bold" FontSize="18" Grid.Row="2">Appearance</Label>
                            <CheckBox x:Name="SettingsShowThirdPanelCheckBox" Grid.Row="3" Margin="20,0,0,0" Checked="SettingsShowThirdPanelCheckBox_Checked" Unchecked="SettingsShowThirdPanelCheckBox_Unchecked">Show third preview panel</CheckBox-->
                        </Grid>
                        <Grid x:Name="SettingsAboutPanel" Grid.Column="1" Margin="25" Visibility="Hidden">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="2*"/>
                                <RowDefinition Height="1*"/>
                                <RowDefinition Height="1*"/>
                            </Grid.RowDefinitions>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Image Source="/Resources/Icons/LogoLarge.png" Width="100" HorizontalAlignment="Center" Margin="0,50,0,0">
                                    <Image.Effect>
                                        <DropShadowEffect ShadowDepth="0" BlurRadius="10"></DropShadowEffect>
                                    </Image.Effect>
                                </Image>
                                <Label Grid.Row="1" HorizontalAlignment="Center" FontSize="20" FontWeight="Bold">2Compare</Label>
                                <Label Grid.Row="2" x:Name="AppVersionLabel" HorizontalAlignment="Center" FontSize="13"></Label>
                                <Label Grid.Row="3" HorizontalAlignment="Center" FontSize="13">
                                    <Hyperlink NavigateUri="https://www.hopie.tech/" RequestNavigate="Hyperlink_RequestNavigate">
                                        © Hopie Tech 2020
                                    </Hyperlink>
                                </Label>
                            </Grid>
                            <Grid Grid.Row="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="auto" />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <Label FontSize="15" FontWeight="Bold">Third Party Licenses</Label>
                                <Grid Grid.Row="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="auto"/>
                                        <ColumnDefinition Width="auto"/>
                                        <ColumnDefinition Width="auto"/>
                                        <ColumnDefinition Width="auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Label Grid.Column="0">Poppler is licensed under </Label>
                                    <Label Grid.Column="1">
                                    <Hyperlink  NavigateUri="https://www.gnu.org/licenses/old-licenses/gpl-2.0.html" RequestNavigate="Hyperlink_RequestNavigate">
                                        GPLv2 
                                    </Hyperlink> 
                                    </Label>
                                    <Label Grid.Column="2"> and </Label>
                                    <Label Grid.Column="3">
                                    <Hyperlink NavigateUri="https://www.gnu.org/licenses/gpl-3.0.html" RequestNavigate="Hyperlink_RequestNavigate">
                                        GPLv3. 
                                    </Hyperlink>
                                    </Label>
                                </Grid>
                            </Grid>
                            <Grid Grid.Row="2">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="auto"/>
                                    <RowDefinition Height="auto"/>
                                </Grid.RowDefinitions>
                                <Label FontSize="15" FontWeight="Bold">Help</Label>
                                <Button x:Name="RestartWalkthroughButton" Grid.Row="1" HorizontalAlignment="Left" Margin="0,10,0,0" Click="RestartWalkthroughButton_Click">Restart Walkthrough</Button>    
                            </Grid>
                            
                        </Grid>
                        <Grid x:Name="SettingsSubscriptionPanel" Grid.Column="1" Margin="25" Visibility="Visible">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="auto" />
                                <RowDefinition Height="auto" />
                                <RowDefinition Height="auto" />
                                <RowDefinition Height="auto" />
                                <RowDefinition Height="auto" />
                                <RowDefinition Height="auto" />
                                <RowDefinition Height="auto" />
                                <RowDefinition Height="auto" />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="500" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Grid HorizontalAlignment="Stretch" Margin="0,5,0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="1*" />
                                    <ColumnDefinition Width="2*" />
                                </Grid.ColumnDefinitions>
                                <Label VerticalAlignment="Center">License type</Label>
                                <Label VerticalAlignment="Center" x:Name="LicenseTypeLabel" Grid.Column="1">Annual subscription</Label>
                            </Grid>
                            <Grid HorizontalAlignment="Stretch" Grid.Row="1" Margin="0,5,0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="1*" />
                                    <ColumnDefinition Width="2*" />
                                </Grid.ColumnDefinitions>
                                <Label x:Name="LicenseStatusTypeLabel" VerticalAlignment="Center">License status</Label>
                                <Label VerticalAlignment="Center" x:Name="LicenseStatusLabel" Grid.Column="1">Active</Label>
                            </Grid>
                            <Grid HorizontalAlignment="Stretch" Grid.Row="2" Margin="0,5,0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="1*" />
                                    <ColumnDefinition Width="2*" />
                                </Grid.ColumnDefinitions>
                                <Label x:Name="LicenseExpiryTypeLabel" VerticalAlignment="Center">Expires on</Label>
                                <Label VerticalAlignment="Center" x:Name="LicenseExpiryLabel" Grid.Column="1">-</Label>
                            </Grid>
                            <Grid HorizontalAlignment="Stretch" Grid.Row="3" Margin="0,5,0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="1*" />
                                    <ColumnDefinition Width="2*" />
                                </Grid.ColumnDefinitions>
                                <Label VerticalAlignment="Center">Email address</Label>
                                <TextBox VerticalAlignment="Center" x:Name="UserEmailTextBox" Grid.Column="1" FontSize="15" mah:TextBoxHelper.Watermark="example@mail.com" TextChanged="UserEmailTextBox_TextChanged"></TextBox>
                            </Grid>
                            <iconPacks:PackIconFontAwesome x:Name="ValidEmailTick" Grid.Column="1" Grid.Row="3" VerticalAlignment="Center" Margin="10,0,0,0" Foreground="Green" Kind="CheckSolid" Visibility="Hidden" />
                            <iconPacks:PackIconFontAwesome x:Name="InvalidEmailTick" Grid.Column="1" Grid.Row="3" VerticalAlignment="Center" Margin="10,0,0,0" Foreground="DarkRed" Kind="TimesSolid" Visibility="Hidden" />
                            <Grid HorizontalAlignment="Stretch" Grid.Row="4" Margin="0,5,0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="1*" />
                                    <ColumnDefinition Width="2*" />
                                </Grid.ColumnDefinitions>
                                <Label VerticalAlignment="Center">License key</Label>
                                <TextBox x:Name="LicenseKeyTextBox" Grid.Column="1" FontSize="15" mah:TextBoxHelper.Watermark="XXXX-XXXX-XXXX-XXXX" VerticalAlignment="Center" TextChanged="LicenseKeyTextBox_TextChanged"></TextBox>
                            </Grid>
                            <iconPacks:PackIconFontAwesome x:Name="ValidKeyTick" Grid.Column="1" Grid.Row="4" VerticalAlignment="Center" Margin="10,0,0,0" Foreground="Green" Kind="CheckSolid" Visibility="Hidden" />
                            <iconPacks:PackIconFontAwesome x:Name="InvalidKeyTick" Grid.Column="1" Grid.Row="4" VerticalAlignment="Center" Margin="10,0,0,0" Foreground="DarkRed" Kind="TimesSolid" Visibility="Hidden" />
                            <Label x:Name="LicenseKeyHintText" Grid.Column="1" Grid.Row="3"></Label>
                            <Grid HorizontalAlignment="Stretch" Grid.Row="5" Margin="0,5,0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="1*" />
                                    <ColumnDefinition Width="2*" />
                                </Grid.ColumnDefinitions>
                                <Button x:Name="ActivateLicenseButton" Padding="0" Grid.Column="1" HorizontalAlignment="Stretch" Click="ActivateLicenseButton_Click">Activate</Button>
                                <Button x:Name="ChangeLicenseButton" Padding="0" Grid.Column="1" HorizontalAlignment="Stretch" Click="ChangeLicenseButton_Click" Visibility="Hidden">Change License</Button>
                            </Grid>
                            <Grid x:Name="ExtendTrialGrid1" HorizontalAlignment="Stretch" Grid.Row="6" Margin="0,50,0,5" Visibility="Hidden">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="1*" />
                                    <ColumnDefinition Width="2*" />
                                </Grid.ColumnDefinitions>
                                <Label VerticalAlignment="Center">Extend trial</Label>
                                <TextBox VerticalAlignment="Center" x:Name="ExtendTrialTextBox" Grid.Column="1" FontSize="15" mah:TextBoxHelper.Watermark="XXXX-XXXX-XXXX-XXXX" TextChanged="ExtendTrialTextBox_TextChanged"></TextBox>
                            </Grid>
                            <iconPacks:PackIconFontAwesome x:Name="ValidTrialKeyTick" Grid.Column="1" Grid.Row="6" VerticalAlignment="Center" Margin="10,45,0,0" Foreground="Green" Kind="CheckSolid" Visibility="Hidden" />
                            <iconPacks:PackIconFontAwesome x:Name="InvalidTrialKeyTick" Grid.Column="1" Grid.Row="6" VerticalAlignment="Center" Margin="10,45,0,0" Foreground="DarkRed" Kind="TimesSolid" Visibility="Hidden" />

                            <Grid x:Name="ExtendTrialGrid2" HorizontalAlignment="Stretch" Grid.Row="7" Margin="0,5,0,5" Visibility="Hidden">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="1*" />
                                    <ColumnDefinition Width="2*" />
                                </Grid.ColumnDefinitions>
                                <Button x:Name="ExtendTrialButton" Padding="0" Grid.Column="1" HorizontalAlignment="Stretch" Click="ExtendTrialButton_Click">Extend</Button>
                            </Grid>
                        </Grid>
                    </Grid>
                    <Grid x:Name="SelectReferenceDocPanel" Visibility="Hidden" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="1*" />
                            <ColumnDefinition Width="1*" />
                        </Grid.ColumnDefinitions>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="{StaticResource TopBarHeight}" />
                                <RowDefinition />
                                <RowDefinition Height="50" />
                            </Grid.RowDefinitions>
                            <Grid Grid.Row="0" Grid.Column="0" Background="{DynamicResource SecondaryAccentBrush}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                <Label Foreground="White" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="10,0,0,0" >Select the reference document</Label>
                            </Grid>
                            <ListBox x:Name="RefDocListBox" Grid.Row="1" SelectedIndex="0" SelectionChanged="RefDocListBox_SelectionChanged">
                            </ListBox>
                            <Button x:Name="RefDocProceedButton" Grid.Row="2" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,10,0" Click="RefDocProceedButton_Click">Proceed</Button>
                        </Grid>
                        <Grid Grid.Column="1">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="{StaticResource TopBarHeight}" />
                                <RowDefinition />
                                <RowDefinition Height="{StaticResource BottomBarHeight}" />
                            </Grid.RowDefinitions>

                            <Grid Grid.Row="0" Grid.Column="1" Background="{DynamicResource SecondaryAccentBrush}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                <Label Foreground="White" VerticalAlignment="Center" HorizontalAlignment="Center" >Preview</Label>
                            </Grid>
                            <ScrollViewer x:Name="RefDocScrollViewer" Grid.Row="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" ScrollChanged="RefDocScrollViewer_ScrollChanged">
                            </ScrollViewer>
                            <Grid Grid.Row="2" Grid.Column="1" Background="{DynamicResource SecondaryAccentBrush}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                <Label x:Name="RefDocPageNumberLabel" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="White"></Label>
                            </Grid>
                        </Grid>
                    </Grid>
                    <mah:Tile x:Name="ProcessingDocProgressCard" Padding="4" HorizontalAlignment="Right" VerticalAlignment="Bottom" Visibility="Hidden" Height="90" Width="500" Background="{StaticResource SecondaryAccentBrush}" BorderBrush="Black" BorderThickness="1"
                              Margin="0,0,10,40">
                        <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="496" Height="86">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="2*" />
                                <RowDefinition Height="1*" />
                            </Grid.RowDefinitions>
                            <TextBlock x:Name="ProcessingDocLabel" FontSize="14" Foreground="White" Margin="10,0,10,0" HorizontalAlignment="Left" VerticalAlignment="Center" TextTrimming="WordEllipsis">Processing: Example.pptx</TextBlock>
                            <ProgressBar x:Name="ProcessingDocProgressbar" Style="{x:Null}" Margin="10,0,10,0" Grid.Row="1" Value="20" HorizontalAlignment="Stretch" Height="7" Foreground="White" Background="{StaticResource SecondaryAccentBrush}"></ProgressBar>
                        </Grid>
                    </mah:Tile>
                </Grid>
            </Grid>            
        </Grid>
    </Border>
</Window>